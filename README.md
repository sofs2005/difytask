# DifyTask 定时任务插件

一个支持多种定时格式的微信定时消息插件。

作者: sofs2005
版本: v1.3.5
描述: 支持多种定时格式的微信定时消息插件
许可: MIT License

## 功能特点
- 支持多种时间格式：每天、工作日、每周、今明后天、指定日期、Cron表达式
- 支持私聊和群聊消息发送
- 支持在私聊中创建群任务
- 支持任务列表查看（密码保护）
- 使用 SQLite 持久化存储任务数据

## 使用方法

### 1. 提醒功能
直接发送提醒内容，格式：`提醒 + 内容`

# 喝水提醒（每30分钟）
$time cron[*/30 * * * *] 提醒喝水了，该补充水分了

# 休息提醒（每2小时）
$time cron[0 */2 * * 1-5] 提醒久坐伤身，起来走动一下

# 吃饭提醒（每天）
$time 每天 12:00 提醒该吃午饭了
$time 每天 18:00 提醒晚饭时间到了

### 2. 消息转发
不带"提醒"前缀的内容会被直接转发给对应的插件处理

# 使用总结插件，获取最近5小时的新闻
$time 每天 08:00 总结 -5h

# 使用画图插件，生成早安图片
$time 每天 09:00 画一个早安图片

# 使用天气插件，获取天气信息
$time 每天 07:30 上海天气

# 直接发送消息
$time 每天 09:00 早安，新的一天开始了
$time 工作日 18:00 下班愉快

### 3. 私聊创建群任务
# 在私聊中创建群任务，使用g[群名]格式
$time 每天 09:30 g[测试群]早安打卡

### 4. 任务管理
# 查看任务列表（需要密码）
$time 任务列表 你的密码

# 取消任务
$time 取消 任务ID

## Cron表达式说明
格式：`分 时 日 月 周`
- 分钟：0-59
- 小时：0-23
- 日期：1-31
- 月份：1-12
- 星期：0-7（0和7都表示周日）

特殊字符：
- `*`：表示任意值
- `,`：表示多个值，如 `1,3,5`
- `-`：表示范围，如 `1-5`
- `/`：表示间隔，如 `*/5`

常用示例：
- `0 9 * * 1-5`：工作日早上9点
- `*/30 * * * *`：每30分钟
- `0 */2 * * *`：每2小时
- `0 12 * * *`：每天中午12点

## 配置说明
在插件目录下创建 `config.json`：
{
    "task_list_password": "你的密码"  // 查看任务列表的密码
}

## 注意事项
1. 时间格式必须是24小时制，如 `09:30`、`18:00`
2. 查看任务列表需要配置密码
3. 取消任务需要任务ID，可以从任务列表中查看
4. 在私聊中创建群任务时，需要确保机器人在目标群中
5. 由于微信机制，请在机器人微信上将所有群聊保存后重启插件，否则将无法拿到群信息

开源不易，感谢打赏支持！

![打赏](https://github.com/sofs2005/difytask/blob/main/img/wx.png?raw=true)
